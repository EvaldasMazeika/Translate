@model PrDocViewModel

@inject translate.web.Resources.LocService SharedLocalizer
<a asp-controller="Project" asp-action="Index" class="btn btn-info"><i class="fa fa-angle-double-left"></i> @SharedLocalizer.GetLocalizedHtmlString("goBackButton")</a>
@if (!Model.HasDoc)
{
    <a asp-controller="Project" asp-action="NewDocument" class="btn btn-primary">@SharedLocalizer.GetLocalizedHtmlString("addDocumentButton")</a>
}
else
{
    <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#downloadModal">Parsisiųsti dokumentą</button>
    <p>Dokumento kalba: <strong>@Model.Language</strong></p>
}

<hr />
@if (Model.HasDoc)
{
    <div class="table table-responsive">
        <table id="example" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th scope="col">Raktas</th>
                    <th scope="col">Reikšmė</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <th scope="col">Raktas</th>
                    <th scope="col">Reikšmė</th>
                </tr>
            </tfoot>
        </table>
    </div>
}
else
{
    <h2 class="text-warning text-center">@SharedLocalizer.GetLocalizedHtmlString("noDucumentsTitle")</h2>
}

<div class="modal fade" id="downloadModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="downloadModalLabel">New message</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="recipient-name" class="col-form-label">Pavadinimas:</label>
                        <input type="text" class="form-control" id="nameTitle">
                    </div>
                    <div class="form-group">
                        <label for="message-text" class="col-form-label">Dokumento tipas:</label>
                        <select id="typeDoc" class="form-control" asp-items="ViewBag.DocumentTypeId"></select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button id="downloadBtn" type="button" class="btn btn-primary">Parsisiųsti</button>
            </div>
        </div>
    </div>
</div>



@section scripts {
    <script>
        if ('@Model.HasDoc' == 'True') {

            var table = jQuery('#example').DataTable({
                "ajax": {
                    "url": "/Project/@ViewBag.projectId/GetDocWordsAsync",
                    "dataSrc": ""
                },
                "columns": [
                    { "data": "key" },
                    { "data": "value" },
                ]
            });
        }

        jQuery('#downloadBtn').click(function (e) {
            e.preventDefault();
            if (jQuery('#nameTitle').val().length > 0) {
                var title = jQuery('#nameTitle').val();
                var extId = jQuery('#typeDoc').val();

                jQuery('#downloadModal').modal('hide');
                window.location = '/Project/@ViewBag.projectId/DownloadDocAsync?Title=' + title + '&ExtensionId=' + extId ;
            }
         });
    </script>
}

